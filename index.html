<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ผลหวยฮานอย</title>
  <style>
    body {
      margin: 0;
      padding: 1rem;
      font-family: 'Prompt', sans-serif;
      background: #f5f5f5;
      display: flex;
      justify-content: center;
    }

    .lotto-container {
      position: relative;
      width: 768px;
      max-width: 100%;
    }

    .lotto-image {
      width: 100%;
      display: block;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    }

    .overlay-text {
      position: absolute;
      font-size: 1.8rem;
      font-weight: bold;
      color: #004080;
      text-align: center;
      width: 100px;
    }

    /* ตำแหน่งตัวเลข - พิเศษ */
    .ps-3up { top: 185px; left: 130px; }
    .ps-2down { top: 185px; right: 130px; }

    /* ปกติ */
    .n-3up { top: 505px; left: 130px; }
    .n-2down { top: 505px; right: 130px; }

    /* VIP */
    .vip-3up { top: 820px; left: 130px; }
    .vip-2down { top: 820px; right: 130px; }

    @media (max-width: 500px) {
      .overlay-text {
        font-size: 1.2rem;
        width: 80px;
      }
    }
  </style>
</head>
<body>
  <div class="lotto-container">
    <img
      class="lotto-image"
      src="https://drive.google.com/uc?export=view&id=1kYtguHKv8hZzwVwO7W1IqO-3BvXpAGjm"
      alt="ผลหวยฮานอย"
    />

    <!-- ตำแหน่งแสดงผล -->
    <div class="overlay-text ps-3up" id="ps_3up"></div>
    <div class="overlay-text ps-2down" id="ps_2down"></div>
    <div class="overlay-text n-3up" id="n_3up"></div>
    <div class="overlay-text n-2down" id="n_2down"></div>
    <div class="overlay-text vip-3up" id="vip_3up"></div>
    <div class="overlay-text vip-2down" id="vip_2down"></div>
  </div>

  <script>
    const sheetID = '1KfkvO09PAEI12wLn7taGXGutXgbBdK4bjVpcMPwNg_A';
    const sheetName = 'Sheet1';
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

    fetch(url)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        // ค่าที่เราจะใส่ในแต่ละช่อง overlay
        const values = {
          ps_3up: rows[1]?.c[1]?.v || '',
          ps_2down: rows[2]?.c[1]?.v || '',
          n_3up: rows[3]?.c[1]?.v || '',
          n_2down: rows[4]?.c[1]?.v || '',
          vip_3up: rows[5]?.c[1]?.v || '',
          vip_2down: rows[6]?.c[1]?.v || ''
        };

        for (const id in values) {
          document.getElementById(id).textContent = values[id];
        }
      });
  </script>
</body>
</html>
